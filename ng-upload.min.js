angular.module("ngUpload",[]).directive("uploadSubmit",["$parse",function(t){return{restrict:"AC",link:function(e,a,n){var i={};i.enableControls=n.uploadOptionsEnableControls;var r=angular.element(a).parents("form"),o=t(n.uploadSubmit);if(!angular.isFunction(o)){var l="The expression on the ngUpload directive does not point to a valid function.";throw l+"\n"}a.bind("click",function(t){if(t&&(t.preventDefault=!0),!a.attr("disabled")){if(!r.find("input[type='file']")[0].value)return alert("There is no file chosen yet."),void 0;var n=angular.element("<iframe id='upload_iframe' name='upload_iframe' border='0' width='0' height='0' style='width: 0px; height: 0px; border: none; display: none' />");n.bind("load",function(){var t=n.contents().find("body").html();e.$apply(function(){o(e,{content:t,completed:!0})}),""!==t&&setTimeout(function(){n.remove()},250),a.attr("disabled",null),a.attr("title","Click to start upload.")}),r.parent().append(n),e.$apply(function(){o(e,{content:"Please wait...",completed:!1})});var l=!0;i.enableControls||(a.attr("disabled","disabled"),l=!1),a.attr("title",(l?"[ENABLED]: ":"[DISABLED]: ")+"Uploading, please wait..."),r.submit()}}).attr("title","Click to start upload.")}}}]).directive("ngUpload",["$parse",function(){return{restrict:"AC",link:function(t,e){e.attr("target","upload_iframe"),e.attr("method","post");var a=-1==e.attr("action").indexOf("?")?"?":"&";e.attr("action",e.attr("action")+a+"_t="+(new Date).getTime()),e.attr("enctype","multipart/form-data"),e.attr("encoding","multipart/form-data")}}}]);